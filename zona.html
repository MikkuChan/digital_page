<!DOCTYPE html>
<html lang="id" class="light-mode">
<head>
  <meta charset="UTF-8" />
  <title>Pembagian Zona Koneksi â€“ fadzdigital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Pembagian zona koneksi: Barat vs Timur. Daftar provinsi dan kota/kab se-Indonesia." />
  <link rel="icon" href="https://raw.githubusercontent.com/fadzdigital/image/main/favicon.ico" />
  <base href="/" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet"/>

  <!-- Global & Page CSS -->
  <link href="/css/style.css" rel="stylesheet"/>
  <link href="/css/zona.css" rel="stylesheet"/>
</head>
<body>
  <!-- Loading overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
  </div>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="/index.html">
        <img src="https://raw.githubusercontent.com/fadzdigital/image/main/fadzdigital.png" alt="fadzdigital Logo" style="height:38px;width:auto;object-fit:contain"/>
        <span class="text-gradient" style="font-size:2rem;font-weight:700;">fadzdigital</span>
      </a>
      <button class="navbar-toggler border-0 p-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mx-auto">
          <li class="nav-item"><a class="nav-link" href="/index.html">Beranda</a></li>
          <li class="nav-item"><a class="nav-link" href="/index.html#features">Fitur</a></li>
          <li class="nav-item"><a class="nav-link" href="/ordervpn.html">Order VPN</a></li>
          <li class="nav-item"><a class="nav-link" href="/tutorial.html">Tutorial</a></li>
          <li class="nav-item"><a class="nav-link active" href="/tools.html">Tools</a></li>
          <li class="nav-item"><a class="nav-link" href="/index.html#contact">Kontak</a></li>
        </ul>
        <div class="d-flex align-items-center gap-3">
          <a href="https://wa.me/6285727035336" class="btn btn-success d-none d-lg-inline-flex">WhatsApp</a>
          <a href="https://t.me/fadzdigital" class="btn btn-primary">Telegram</a>
        </div>
      </div>
    </div>
  </nav>

  <main style="margin-top:90px;min-height:100vh;">
    <!-- HERO -->
    <section class="zona-hero text-center font-display py-5 mb-0 position-relative overflow-hidden">
      <div class="hero-decor hero-decor-1"></div>
      <div class="hero-decor hero-decor-2"></div>
      <div class="container">
        <span class="badge-tools mb-4 px-4 py-2 fs-6 d-inline-flex align-items-center shadow-sm">
          <i class="bi bi-diagram-3 me-2"></i>Pembagian Zona Koneksi
        </span>
        <h1 class="display-5 fw-bold mb-3" style="letter-spacing:-1px;color:#1f2937;">
          Zona <span class="text-gradient">Barat</span> & <span class="text-gradient">Timur</span>
        </h1>
        <p class="lead mx-auto mb-2" style="max-width:860px;color:#4b5563;">
          Lihat pembagian zona per provinsi & kota/kab se-Indonesia.
        </p>
        <div class="tips small text-muted">
          <i class="bi bi-lightbulb-fill text-warning"></i>
          Catatan: <b>Cilacap</b> (dekat Jabar) sering diperlakukan sebagai Zona Barat.
        </div>
      </div>
    </section>

    <!-- TOOLBAR STICKY -->
    <div class="zona-toolbar shadow-sm">
      <div class="container d-flex flex-wrap align-items-center gap-2 py-2">
        <div class="input-group input-group-sm flex-grow-1" style="max-width:520px;">
          <span class="input-group-text"><i class="bi bi-search"></i></span>
          <input id="searchInput" type="text" class="form-control" placeholder="Cari kota/provinsiâ€¦ (cth: Surabaya / Aceh / Sumbar)"/>
        </div>
        <div class="ms-auto d-flex flex-wrap gap-2">
          <button class="btn btn-tab active" data-filter="all"><i class="bi bi-grid"></i> Semua</button>
          <button class="btn btn-tab" data-filter="barat"><i class="bi bi-sunset"></i> Zona Barat</button>
          <button class="btn btn-tab" data-filter="timur"><i class="bi bi-sunrise"></i> Zona Timur</button>
          <button class="btn btn-soft" id="btnReset" title="Reset filter"><i class="bi bi-arrow-counterclockwise"></i></button>
        </div>
      </div>
    </div>

    <!-- KONTEN -->
    <section class="container py-5">
      <div class="row g-3 mb-4">
        <div class="col-6 col-md-3"><div class="mini-stat"><div class="label">Provinsi</div><div class="value" id="statProv">â€”</div></div></div>
        <div class="col-6 col-md-3"><div class="mini-stat"><div class="label">Kota/Kab (contoh)</div><div class="value" id="statCities">â€”</div></div></div>
        <div class="col-6 col-md-3"><div class="mini-stat"><div class="label">Zona Barat</div><div class="value" id="statBarat">â€”</div></div></div>
        <div class="col-6 col-md-3"><div class="mini-stat"><div class="label">Zona Timur</div><div class="value" id="statTimur">â€”</div></div></div>
      </div>

      <div class="zona-card p-0 overflow-hidden">
        <div class="table-header d-flex align-items-center justify-content-between px-3 py-2">
          <div class="d-flex align-items-center gap-2"><i class="bi bi-table"></i><span class="fw-semibold">Tabel Pembagian Zona</span></div>
        </div>

        <div class="table-responsive" id="tableWrap">
          <table class="table table-zona align-middle mb-0">
            <thead>
              <tr>
                <th style="min-width:180px;">Provinsi</th>
                <th>Kota/Kab (contoh & mayor)</th>
                <th style="min-width:110px;">Zona</th>
              </tr>
            </thead>
            <tbody id="zonaTableBody"></tbody>
          </table>
        </div>

        <div class="empty-state text-center p-5 d-none" id="emptyState">
          <div class="empty-emoji">ðŸ”Ž</div>
          <h6 class="fw-bold">Data tidak ditemukan</h6>
          <p class="text-muted mb-2">Coba ubah kata kunci atau reset filter.</p>
          <button class="btn btn-primary btn-sm" id="btnResetEmpty"><i class="bi bi-arrow-counterclockwise me-1"></i>Reset</button>
        </div>
      </div>

      <div class="note small mt-3">
        <i class="bi bi-info-circle"></i>
        Semua kabupaten/kota dalam satu provinsi mengikuti zona yang sama, kecuali ada kebijakan routing khusus dari operator di daerah tertentu.
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="py-4" style="background: var(--gray-900); color:var(--gray-100)">
    <div class="container text-center">
      <div class="mb-2"><span class="fw-bold font-display text-gradient" style="font-size:1.3rem;">fadzdigital</span></div>
      <div class="mb-2 small">&copy; 2025 fadzdigital. All rights reserved.<br/>Made with ðŸ’™ in Indonesia</div>
      <div>
        <a href="/index.html" class="text-primary small text-decoration-none mx-2">Beranda</a>
        <a href="/ordervpn.html" class="text-primary small text-decoration-none mx-2">Order VPN</a>
        <a href="/tutorial.html" class="text-primary small text-decoration-none mx-2">Tutorial</a>
        <a href="/tools.html" class="text-primary small text-decoration-none mx-2">Tools</a>
        <a href="/index.html#contact" class="text-primary small text-decoration-none mx-2">Kontak</a>
      </div>
    </div>
  </footer>

  <!-- JS deps -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/main.js"></script>

  <!-- ========================= ZONA SCRIPT (INLINE) ========================= -->
  <script>
  (function(){
    // Sumber data wilayah
    const API_MAIN  = "https://www.emsifa.com/api-wilayah-indonesia/api";
    const API_LOCAL = "/data"; // opsional: data lokal

    // --- Override manual (opsional) ---
    // Paksa zona provinsi tertentu di sini kalau mau (nama harus mirip API):
    const OVERRIDE_ZONE = {
      // "Kalimantan Barat": "barat",
      // "Papua Barat Daya": "timur",
    };

    // --- Deteksi otomatis dengan alias/keyword ---
    function getZone(provRaw){
      const p = provRaw.toLowerCase().trim();

      // override manual menang dulu
      if (OVERRIDE_ZONE[provRaw]) return OVERRIDE_ZONE[provRaw];

      // kata kunci "zona barat"
      const westPatterns = [
        /aceh/,
        /sumatera/,           // semua Sumatera
        /riau/,               // Riau & Kep. Riau
        /jambi/,
        /bengkulu/,
        /lampung/,
        /bangka|belitung/,    // Kepulauan Bangka Belitung
        /jakarta|dki/,        // DKI Jakarta
        /banten/,
        /jawa\s*barat/,
        /kalimantan\s*barat/,
      ];
      if (westPatterns.some(rx => rx.test(p))) return "barat";

      // default timur
      return "timur";
    }

    // DOM helpers
    const $  = (s, el=document) => el.querySelector(s);
    const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));

    const STATE = { rows:[], filtered:[] };

    const zoneBadge = z => z==="barat"
      ? '<span class="badge-zone badge-barat">Barat</span>'
      : '<span class="badge-zone badge-timur">Timur</span>';

    function renderTable(data){
      const tbody = $("#zonaTableBody");
      const empty = $("#emptyState");
      tbody.innerHTML = "";

      data.forEach(item=>{
        const chips = item.cities.map(c=>`<span class="city-chip"><i class="bi bi-geo-alt"></i>${c.name}</span>`).join(" ");
        const tr = document.createElement("tr");
        tr.setAttribute("data-zone", item.zone);
        tr.innerHTML = `
          <td class="fw-semibold">${item.prov}</td>
          <td>${chips}</td>
          <td>${zoneBadge(item.zone)}</td>`;
        tbody.appendChild(tr);
      });

      $("#statProv").textContent   = data.length;
      $("#statBarat").textContent  = data.filter(x=>x.zone==="barat").length;
      $("#statTimur").textContent  = data.filter(x=>x.zone==="timur").length;
      $("#statCities").textContent = data.reduce((a,b)=>a+b.cities.length,0);

      empty.classList.toggle("d-none", data.length>0);
    }

    function applyFilter(){
      const q = $("#searchInput").value.trim().toLowerCase();
      const tab = $(".btn-tab.active")?.getAttribute("data-filter") || "all";
      STATE.filtered = STATE.rows.filter(row=>{
        const zoneOK = tab==="all" ? true : row.zone===tab;
        if(!zoneOK) return false;
        if(!q) return true;
        return row.prov.toLowerCase().includes(q) || row.cities.some(c=>c.name.toLowerCase().includes(q));
      });
      renderTable(STATE.filtered);
    }
    function setActiveTab(btn){
      $$(".btn-tab").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      applyFilter();
    }

    async function fetchJSON(url){
      const r = await fetch(url, {cache:"no-cache"});
      if(!r.ok) throw new Error(`HTTP ${r.status} on ${url}`);
      return r.json();
    }
    async function loadProvinces(){
      try { return await fetchJSON(`${API_MAIN}/provinces.json`); } catch {}
      try { return await fetchJSON(`${API_LOCAL}/provinces.json`); } catch {}
      return [
        { id:"11", name:"Aceh" },{ id:"31", name:"DKI Jakarta" },{ id:"32", name:"Jawa Barat" },
        { id:"33", name:"Jawa Tengah" },{ id:"35", name:"Jawa Timur" },{ id:"51", name:"Bali" }
      ];
    }
    async function loadRegencies(provId){
      try { return await fetchJSON(`${API_MAIN}/regencies/${provId}.json`); } catch {}
      try { return await fetchJSON(`${API_LOCAL}/regencies/${provId}.json`); } catch {}
      const seed = {
        "11":[{id:"1101",name:"Kota Banda Aceh"},{id:"1102",name:"Kota Lhokseumawe"}],
        "31":[{id:"3171",name:"Jakarta Pusat"},{id:"3172",name:"Jakarta Selatan"},{id:"3173",name:"Jakarta Barat"},{id:"3174",name:"Jakarta Timur"},{id:"3175",name:"Jakarta Utara"}],
        "32":[{id:"3273",name:"Kota Bekasi"},{id:"3279",name:"Kota Depok"},{id:"3277",name:"Kota Cimahi"},{id:"3275",name:"Kota Bogor"}],
        "33":[{id:"3374",name:"Kota Semarang"},{id:"3372",name:"Kota Surakarta"},{id:"3301",name:"Kab. Cilacap"}],
        "35":[{id:"3578",name:"Kota Surabaya"},{id:"3573",name:"Kota Malang"},{id:"3515",name:"Kab. Sidoarjo"}],
        "51":[{id:"5171",name:"Kota Denpasar"},{id:"5103",name:"Kab. Badung"}],
      };
      return seed[provId] || [];
    }

    async function loadAll(){
      $("#zonaTableBody").innerHTML = `
        <tr><td colspan="3" class="text-center py-5 text-muted">
          <div class="spinner-border me-2" role="status" aria-hidden="true"></div>
          Memuat data provinsi & kab/kota seluruh Indonesiaâ€¦
        </td></tr>`;
      const provs = await loadProvinces();

      const rows = await Promise.all(provs.map(async p=>{
        // tentukan zona yang benar
        const zone = getZone(p.name);
        const cities = await loadRegencies(p.id);
        cities.sort((a,b)=>a.name.localeCompare(b.name,"id"));
        return { prov:p.name, zone, cities:cities.map(c=>({id:c.id, name:c.name})) };
      }));

      // urut: barat dulu, lalu timur; kemudian alfabet
      rows.sort((a,b)=> (a.zone===b.zone ? a.prov.localeCompare(b.prov,"id") : (a.zone==="barat" ? -1 : 1)));

      STATE.rows = STATE.filtered = rows;
      renderTable(rows);
    }

    document.addEventListener("DOMContentLoaded", ()=>{
      loadAll().catch(err=>{
        console.error(err);
        $("#zonaTableBody").innerHTML = `
          <tr><td colspan="3" class="text-center py-5 text-danger">
            Gagal memuat data wilayah. Refresh (Ctrl/Cmd+R) atau sediakan data lokal di <code>/data</code>.
          </td></tr>`;
      });

      $("#searchInput").addEventListener("input", applyFilter);
      $$(".btn-tab").forEach(btn=>btn.addEventListener("click",()=>setActiveTab(btn)));
      $("#btnReset").addEventListener("click", ()=>{ $("#searchInput").value=""; setActiveTab($('[data-filter="all"]')); });
      const btnResetEmpty = $("#btnResetEmpty");
      if(btnResetEmpty) btnResetEmpty.addEventListener("click", ()=>{ $("#searchInput").value=""; setActiveTab($('[data-filter="all"]')); });
    });

    // Loading overlay hide
    window.addEventListener('load', function () {
      setTimeout(function () {
        const el = document.getElementById('loadingOverlay');
        if (!el) return;
        el.style.opacity = '0';
        setTimeout(function () { el.style.display = 'none'; }, 600);
      }, 400);
    });
  })();
  </script>
  <!-- ======================= /ZONA SCRIPT (INLINE) ======================= -->
</body>
</html>
